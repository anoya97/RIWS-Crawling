{"ast":null,"code":"var _jsxFileName = \"/home/raul/Escritorio/RIWS/RIWS-Crawling/Dineology/dineology-search/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport axios from 'axios';\nimport './App.css';\nimport logo from './Logo.png';\nimport Filters from './components/filters/Filters';\nimport SearchBar from './components/searchBar/SearchBar';\nimport RestaurantCard from './components/restaurantCard/RestaurantCard';\nimport { processMealTypes, renderStarsAndSoles, getPriceSymbols } from './utils/utils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [query, setQuery] = useState('');\n  const [results, setResults] = useState([]);\n  const [filteredResults, setFilteredResults] = useState([]);\n  const [notFound, setNotFound] = useState(false);\n  const [filters, setFilters] = useState({\n    starsOrSoles: 'both',\n    priceRange: '',\n    mealType: '',\n    starNumber: ''\n  });\n  const [filterOptions, setFilterOptions] = useState({\n    priceRanges: [],\n    mealTypes: []\n  });\n  const [showFilters, setShowFilters] = useState(false);\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  // Manejo de búsqueda\n  const handleSearch = async e => {\n    e.preventDefault();\n    await fetchResults(query);\n  };\n  const fetchResults = useCallback(async searchQuery => {\n    if (!searchQuery) return;\n    try {\n      const response = await axios.post('http://localhost:9200/restaurants/_search', {\n        size: 1000,\n        query: {\n          bool: {\n            should: [{\n              term: {\n                \"name.keyword\": searchQuery.toLowerCase()\n              }\n            }, {\n              match: {\n                \"name\": searchQuery.toLowerCase()\n              }\n            }, {\n              wildcard: {\n                \"name\": `*${searchQuery.toLowerCase()}*`\n              }\n            }, {\n              wildcard: {\n                \"meal_type\": `*${searchQuery.toLowerCase()}*`\n              }\n            }],\n            minimum_should_match: 1\n          }\n        }\n      });\n      const processedHits = response.data.hits.hits.map(hit => {\n        var _restaurant$menu_opti;\n        const restaurant = hit._source;\n        if (!restaurant.price && ((_restaurant$menu_opti = restaurant.menu_options) === null || _restaurant$menu_opti === void 0 ? void 0 : _restaurant$menu_opti.length) > 0) {\n          const menuPrices = restaurant.menu_options.map(menu => parseFloat(menu.price.replace(/[^0-9.,]/g, '').replace(',', '.')) || 0).filter(price => price > 0);\n          if (menuPrices.length > 0) {\n            const averagePrice = menuPrices.reduce((a, b) => a + b, 0) / menuPrices.length;\n            restaurant.price = getPriceSymbols(averagePrice);\n          }\n        }\n        return {\n          ...hit,\n          _source: restaurant\n        };\n      });\n      setResults(processedHits);\n      setFilteredResults(processedHits);\n      setNotFound(processedHits.length === 0);\n      const allMealTypes = processedHits.reduce((types, hit) => {\n        const mealTypes = processMealTypes(hit._source.meal_type);\n        return [...types, ...mealTypes];\n      }, []);\n      setFilterOptions({\n        priceRanges: [...new Set(processedHits.map(hit => hit._source.price).filter(price => price))].sort((a, b) => a.length - b.length),\n        mealTypes: [...new Set(allMealTypes)].sort()\n      });\n    } catch (error) {\n      console.error(\"Error fetching data:\", error);\n    }\n  }, []);\n  useEffect(() => {\n    if (location.state && location.state.query) {\n      setQuery(location.state.query);\n      fetchResults(location.state.query);\n    }\n  }, [location.state, fetchResults]);\n  const handleResultClick = restaurant => {\n    const restaurantName = restaurant._source.name.replace(/\\s+/g, '-').toLowerCase();\n    navigate(`/${restaurantName}`, {\n      state: {\n        query,\n        restaurant: restaurant._source\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      src: logo,\n      alt: \"Logo\",\n      className: \"App-logo\",\n      onClick: () => setQuery('') // Reset query\n      ,\n      style: {\n        cursor: 'pointer'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SearchBar, {\n      query: query,\n      setQuery: setQuery,\n      handleSearch: handleSearch,\n      setShowFilters: setShowFilters\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Filters, {\n      filters: filters,\n      setFilters: setFilters,\n      filterOptions: filterOptions,\n      showFilters: showFilters\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), notFound && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"notFound\",\n      children: [\"No se encontraron resultados para \\\"\", query, \"\\\".\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 20\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"resultsGrid\",\n      children: filteredResults.map(result => /*#__PURE__*/_jsxDEV(RestaurantCard, {\n        result: result,\n        handleResultClick: handleResultClick\n      }, result._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"r82+ywciDxjl736kyzG/aWpdpK8=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useNavigate","useLocation","axios","logo","Filters","SearchBar","RestaurantCard","processMealTypes","renderStarsAndSoles","getPriceSymbols","jsxDEV","_jsxDEV","App","_s","query","setQuery","results","setResults","filteredResults","setFilteredResults","notFound","setNotFound","filters","setFilters","starsOrSoles","priceRange","mealType","starNumber","filterOptions","setFilterOptions","priceRanges","mealTypes","showFilters","setShowFilters","navigate","location","handleSearch","e","preventDefault","fetchResults","searchQuery","response","post","size","bool","should","term","toLowerCase","match","wildcard","minimum_should_match","processedHits","data","hits","map","hit","_restaurant$menu_opti","restaurant","_source","price","menu_options","length","menuPrices","menu","parseFloat","replace","filter","averagePrice","reduce","a","b","allMealTypes","types","meal_type","Set","sort","error","console","state","handleResultClick","restaurantName","name","className","children","src","alt","onClick","style","cursor","fileName","_jsxFileName","lineNumber","columnNumber","result","_id","_c","$RefreshReg$"],"sources":["/home/raul/Escritorio/RIWS/RIWS-Crawling/Dineology/dineology-search/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport axios from 'axios';\nimport './App.css';\nimport logo from './Logo.png';\nimport Filters from './components/filters/Filters';\nimport SearchBar from './components/searchBar/SearchBar';\nimport RestaurantCard from './components/restaurantCard/RestaurantCard';\nimport { processMealTypes, renderStarsAndSoles, getPriceSymbols } from './utils/utils';\n\nfunction App() {\n  const [query, setQuery] = useState('');\n  const [results, setResults] = useState([]);\n  const [filteredResults, setFilteredResults] = useState([]);\n  const [notFound, setNotFound] = useState(false);\n  const [filters, setFilters] = useState({\n    starsOrSoles: 'both',\n    priceRange: '',\n    mealType: '',\n    starNumber: '',\n  });\n  const [filterOptions, setFilterOptions] = useState({\n    priceRanges: [],\n    mealTypes: [],\n  });\n  const [showFilters, setShowFilters] = useState(false);\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  // Manejo de búsqueda\n  const handleSearch = async (e) => {\n    e.preventDefault();\n    await fetchResults(query);\n  };\n\n  const fetchResults = useCallback(async (searchQuery) => {\n    if (!searchQuery) return;\n    try {\n      const response = await axios.post('http://localhost:9200/restaurants/_search', {\n        size: 1000,\n        query: {\n          bool: {\n            should: [\n              { term: { \"name.keyword\": searchQuery.toLowerCase() } },\n              { match: { \"name\": searchQuery.toLowerCase() } },\n              { wildcard: { \"name\": `*${searchQuery.toLowerCase()}*` } },\n              { wildcard: { \"meal_type\": `*${searchQuery.toLowerCase()}*` } },\n            ],\n            minimum_should_match: 1\n          }\n        }\n      });\n\n      const processedHits = response.data.hits.hits.map(hit => {\n        const restaurant = hit._source;\n        if (!restaurant.price && restaurant.menu_options?.length > 0) {\n          const menuPrices = restaurant.menu_options\n            .map(menu => parseFloat(menu.price.replace(/[^0-9.,]/g, '').replace(',', '.')) || 0)\n            .filter(price => price > 0);\n          if (menuPrices.length > 0) {\n            const averagePrice = menuPrices.reduce((a, b) => a + b, 0) / menuPrices.length;\n            restaurant.price = getPriceSymbols(averagePrice);\n          }\n        }\n        return { ...hit, _source: restaurant };\n      });\n\n      setResults(processedHits);\n      setFilteredResults(processedHits);\n      setNotFound(processedHits.length === 0);\n\n      const allMealTypes = processedHits.reduce((types, hit) => {\n        const mealTypes = processMealTypes(hit._source.meal_type);\n        return [...types, ...mealTypes];\n      }, []);\n      setFilterOptions({\n        priceRanges: [...new Set(processedHits.map(hit => hit._source.price).filter(price => price))].sort((a, b) => a.length - b.length),\n        mealTypes: [...new Set(allMealTypes)].sort(),\n      });\n\n    } catch (error) {\n      console.error(\"Error fetching data:\", error);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (location.state && location.state.query) {\n      setQuery(location.state.query);\n      fetchResults(location.state.query);\n    }\n  }, [location.state, fetchResults]);\n\n  const handleResultClick = (restaurant) => {\n    const restaurantName = restaurant._source.name.replace(/\\s+/g, '-').toLowerCase();\n    navigate(`/${restaurantName}`, { state: { query, restaurant: restaurant._source } });\n  };\n\n  return (\n    <div className=\"App\">\n      <img\n        src={logo}\n        alt=\"Logo\"\n        className=\"App-logo\"\n        onClick={() => setQuery('')} // Reset query\n        style={{ cursor: 'pointer' }}\n      />\n      <SearchBar query={query} setQuery={setQuery} handleSearch={handleSearch} setShowFilters={setShowFilters} />\n      <Filters filters={filters} setFilters={setFilters} filterOptions={filterOptions} showFilters={showFilters} />\n\n      {notFound && <p className=\"notFound\">No se encontraron resultados para \"{query}\".</p>}\n\n      <div className=\"resultsGrid\">\n        {filteredResults.map(result => (\n          <RestaurantCard key={result._id} result={result} handleResultClick={handleResultClick} />\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}